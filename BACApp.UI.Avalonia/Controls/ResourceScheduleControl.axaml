<?xml version="1.0" encoding="utf-8"?>
<Styles xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:t="clr-namespace:BACApp.UI.Avalonia.Controls"
        xmlns:i="https://github.com/avaloniaui"
        xmlns:ia="using:Avalonia.Xaml.Interactivity"
        xmlns:iac="using:Avalonia.Xaml.Interactions.Core">

  <Style Selector="t|ResourceScheduleControl">

    <!-- Design-time preview -->
    <Design.PreviewWith>
      <Border Padding="20" Background="LightGray">
        <t:ResourceScheduleControl BackgroundBrush="White"
                                   HeaderWidth="200"
                                   RowHeight="40"
                                   HourWidth="60"
                                   Day="2025-01-01">
          <t:ResourceScheduleControl.Resources>
            <t:Resource Id="1" Name="Aircraft A"/>
            <t:Resource Id="2" Name="Aircraft B"/>
            <t:Resource Id="3" Name="Aircraft C"/>
          </t:ResourceScheduleControl.Resources>

          <t:ResourceScheduleControl.Events>
            <t:ResourceEvent ResourceId="1"
                             Start="2025-01-01T08:00:00+00:00"
                             End="2025-01-01T10:00:00+00:00"
                             Title="Flight 101"
                             Brush="ForestGreen"/>
            <t:ResourceEvent ResourceId="2"
                             Start="2025-01-01T09:00:00+00:00"
                             End="2025-01-01T12:00:00+00:00"
                             Title="Maintenance"
                             Brush="CornflowerBlue"/>
          </t:ResourceScheduleControl.Events>
        </t:ResourceScheduleControl>
      </Border>
    </Design.PreviewWith>

    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate>
          <Grid Background="{TemplateBinding BackgroundBrush}"
                ColumnDefinitions="Auto,*"
                RowDefinitions="*">

            <!-- Left header column with resource names -->
           <Border Background="{DynamicResource ThemeBackgroundBrush}"
                    VerticalAlignment="Top">
              <ScrollViewer HorizontalScrollBarVisibility="Disabled"
                            VerticalScrollBarVisibility="Hidden">
                <StackPanel Orientation="Vertical">
                  <!-- Spacer to align with TimeHeaderHeight -->
                  <Border Height="{TemplateBinding TimeHeaderHeight}" />
                  
                  <!-- Resource name list -->
                  <ItemsControl x:Name="PART_ResourceList"
                                ItemsSource="{TemplateBinding Resources}">
                    <ItemsControl.ItemsPanel>
                      <ItemsPanelTemplate>
                        <StackPanel Orientation="Vertical" />
                      </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                    <ItemsControl.ItemTemplate>
                      <DataTemplate x:CompileBindings="False">
                         <Border Height="{Binding $parent[t:ResourceScheduleControl].RowHeight}"
                                 Background="LightGray"
                                 BorderBrush="{DynamicResource ThemeBorderLowBrush}"
                                 BorderThickness="0,0,0,1"
                                 Width="{Binding $parent[t:ResourceScheduleControl].HeaderWidth}"
                                 Cursor="Hand">
                          <ia:Interaction.Behaviors>
                            <iac:EventTriggerBehavior EventName="Tapped">
                              <iac:InvokeCommandAction 
                                  Command="{Binding $parent[t:ResourceScheduleControl].ResourceClickCommand}"
                                  CommandParameter="{Binding}" />
                            </iac:EventTriggerBehavior>
                          </ia:Interaction.Behaviors>
                          
                             <StackPanel Orientation="Horizontal"
                                         Margin="10,0">
								<TextBlock Text="{Binding Name}"
                                           VerticalAlignment="Center" />
                                <TextBlock Text="{Binding Comment}" 
                                           Margin="10,0"
                                           VerticalAlignment="Center" />
                             </StackPanel>
  
                        </Border>
                      </DataTemplate>
                    </ItemsControl.ItemTemplate>
                  </ItemsControl>
                </StackPanel>
              </ScrollViewer>
            </Border>

            <!-- Timeline area -->
            <ScrollViewer x:Name="PART_ScrollViewer"
                          Grid.Column="1"
                          HorizontalScrollBarVisibility="Auto"
                          VerticalScrollBarVisibility="Disabled"
                          VerticalAlignment="Top"
                          VerticalContentAlignment="Top">
              <Canvas x:Name="PART_TimelineCanvas"
                      Background="{DynamicResource ThemeBackgroundBrush}" />
            </ScrollViewer>
          </Grid>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>
</Styles>